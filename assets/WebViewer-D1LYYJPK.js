const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/webviewer.min-ZPGuvyqp.js","assets/index-C5XVvqVk.js","assets/index-B4QcEkvR.css"])))=>i.map(i=>d[i]);
import{r as u,j as l,_ as W}from"./index-C5XVvqVk.js";const j=({content:o,fileType:n,docId:w})=>{const c=u.useRef(null),[b,i]=u.useState(null),[g,r]=u.useState(!0);u.useEffect(()=>{if(console.log("WebViewer: Component initialized",{fileType:n,docId:w,contentLength:o?o.length:0}),!o){console.error("WebViewer: No content provided"),i("No document content available"),r(!1);return}if(!n){console.error("WebViewer: No file type provided"),i("Unknown document format"),r(!1);return}["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/msword","application/vnd.ms-excel","application/vnd.ms-powerpoint"].includes(n)||console.warn("WebViewer: Attempting to preview potentially unsupported file type",n)},[o,n,w]),u.useEffect(()=>{let t=!0,s=[];return(async()=>{let a="";try{if(!c.current||!o){console.error("WebViewer initialization failed: viewer ref or content missing",{hasViewerRef:!!c.current,contentLength:o?o.length:0}),i("Unable to initialize document viewer"),r(!1);return}r(!0),console.log("WebViewer: Loading document viewer");const x=(await W(()=>import("./webviewer.min-ZPGuvyqp.js").then(e=>e.w),__vite__mapDeps([0,1,2]))).default;console.log("WebViewer: Module loaded successfully");let h=o;o.includes("base64,")?(h=o.split("base64,")[1],console.log("WebViewer: Extracted base64 content from data URL")):console.log("WebViewer: Content does not contain base64 marker, using as is");try{const e=atob(h);console.log(`WebViewer: Decoded base64 string, length: ${e.length}`);const m=new Uint8Array(e.length);for(let p=0;p<e.length;p++)m[p]=e.charCodeAt(p);const d=new Blob([m]);a=URL.createObjectURL(d),console.log("WebViewer: Created blob URL for document",{fileUrl:a}),s.push(()=>URL.revokeObjectURL(a))}catch(e){console.error("WebViewer: Failed to decode base64 content",e),i("Invalid document format"),r(!1);return}try{console.log("WebViewer: Initializing viewer with extension",f(n));const e=await x({path:"/webviewer/lib",initialDoc:a,filename:`document.${f(n)}`,extension:f(n),fullAPI:!0,disabledElements:["toolsHeader","searchButton","menuButton","contextMenuPopup"]},c.current);console.log("WebViewer: Instance created successfully");const m=()=>{t&&(r(!1),console.log("WebViewer: Document loaded successfully"))};s.push(()=>{try{e&&e.UI&&c.current&&(console.log("WebViewer: Running disposal cleanup"),e.UI.dispose())}catch(d){console.error("WebViewer: Error during disposal",d)}}),e.Core&&e.Core.documentViewer?(console.log("WebViewer: Adding document loaded event listener"),e.Core.documentViewer.addEventListener("documentLoaded",m)):console.warn("WebViewer: documentViewer not available for event registration"),e.UI.addEventListener("loaderror",d=>{t&&(console.error("WebViewer: Load error event",d),i("Failed to load document"),r(!1))}),console.log("WebViewer: Initialization complete, waiting for document to load")}catch(e){console.error("WebViewer: Error during viewer initialization",e),i("Error initializing document viewer"),r(!1)}const V=setTimeout(()=>{t&&g&&(r(!1),console.log("Document loading timed out, showing viewer anyway"))},5e3);s.push(()=>clearTimeout(V))}catch(v){t&&(console.error("WebViewer initialization error:",v),i("Failed to initialize document viewer"),r(!1))}})(),()=>{t=!1,s.forEach(a=>a())}},[o,n]);const f=t=>{switch(t){case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":return"docx";case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":return"xlsx";case"application/vnd.openxmlformats-officedocument.presentationml.presentation":return"pptx";case"application/msword":return"doc";case"application/vnd.ms-excel":return"xls";case"application/vnd.ms-powerpoint":return"ppt";default:const s=t.split("/");return s.length===2?s[1].split(";")[0]:""}};return b?l.jsx("div",{className:"flex items-center justify-center p-6 text-red-500",children:l.jsx("p",{children:b})}):g?l.jsxs("div",{className:"flex items-center justify-center p-6",children:[l.jsx("div",{className:"w-8 h-8 border-4 border-pink-600 border-t-transparent rounded-full animate-spin"}),l.jsx("p",{className:"ml-2",children:"Loading document..."})]}):l.jsx("div",{className:"webviewer-container w-full max-w-full overflow-hidden",children:l.jsx("div",{ref:c,className:"w-full rounded-lg border border-gray-200 shadow-inner",style:{height:"min(calc(100vh - 240px), 800px)",minHeight:"400px"}})})};export{j as default};
