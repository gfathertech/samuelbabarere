const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/webviewer.min-B11NM9tI.js","assets/index-BWEF6GYD.js","assets/index-BRHWRo4N.css"])))=>i.map(i=>d[i]);
import{r as c,j as n,_ as L}from"./index-BWEF6GYD.js";const U=({content:s,fileType:d})=>{const l=c.useRef(null),[p,u]=c.useState(null),[f,o]=c.useState(!0);c.useEffect(()=>{let e=!0,r=[];return(async()=>{let a="";try{if(!l.current||!s){u("Unable to initialize document viewer"),o(!1);return}o(!0);const v=(await L(()=>import("./webviewer.min-B11NM9tI.js").then(t=>t.w),__vite__mapDeps([0,1,2]))).default;let b=s;s.includes("base64,")&&(b=s.split("base64,")[1]);const m=atob(b),h=new Uint8Array(m.length);for(let t=0;t<m.length;t++)h[t]=m.charCodeAt(t);const g=new Blob([h]);a=URL.createObjectURL(g),r.push(()=>URL.revokeObjectURL(a));const i=await v({path:"/webviewer/lib",initialDoc:a,filename:`document.${w(d)}`,extension:w(d),fullAPI:!0,disabledElements:["toolsHeader","searchButton","menuButton","contextMenuPopup"]},l.current),j=()=>{e&&(o(!1),console.log("Document loaded successfully"))};r.push(()=>{i&&l.current&&i.UI.dispose()}),i.Core&&i.Core.documentViewer&&i.Core.documentViewer.addEventListener("documentLoaded",j),i.UI.addEventListener("loaderror",t=>{e&&(console.error("WebViewer error:",t),u("Failed to load document"),o(!1))});const E=setTimeout(()=>{e&&f&&(o(!1),console.log("Document loading timed out, showing viewer anyway"))},5e3);r.push(()=>clearTimeout(E))}catch(x){e&&(console.error("WebViewer initialization error:",x),u("Failed to initialize document viewer"),o(!1))}})(),()=>{e=!1,r.forEach(a=>a())}},[s,d]);const w=e=>{switch(e){case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":return"docx";case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":return"xlsx";case"application/vnd.openxmlformats-officedocument.presentationml.presentation":return"pptx";case"application/msword":return"doc";case"application/vnd.ms-excel":return"xls";case"application/vnd.ms-powerpoint":return"ppt";default:const r=e.split("/");return r.length===2?r[1].split(";")[0]:""}};return p?n.jsx("div",{className:"flex items-center justify-center p-6 text-red-500",children:n.jsx("p",{children:p})}):f?n.jsxs("div",{className:"flex items-center justify-center p-6",children:[n.jsx("div",{className:"w-8 h-8 border-4 border-pink-600 border-t-transparent rounded-full animate-spin"}),n.jsx("p",{className:"ml-2",children:"Loading document..."})]}):n.jsx("div",{className:"webviewer-container w-full max-w-full overflow-hidden",children:n.jsx("div",{ref:l,className:"w-full rounded-lg border border-gray-200 shadow-inner",style:{height:"min(calc(100vh - 240px), 800px)",minHeight:"400px"}})})};export{U as default};
